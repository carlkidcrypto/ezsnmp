=============
Python Tests
=============

Overview
========
This directory contains the Python unit tests for EzSnmp. These tests use pytest to 
validate the Python API and ensure compatibility across different Python versions.

Purpose
=======
The Python tests ensure that:

* The Session class API works correctly
* SNMP v1, v2c, and v3 operations function properly
* Authentication and privacy protocols work as expected
* Error handling and exceptions are raised appropriately
* Results are formatted correctly
* Python 3.9+ compatibility is maintained

Test Structure
==============
The tests are organized to cover:

* **Session operations**: GET, SET, WALK, BULKGET, BULKWALK
* **Protocol versions**: SNMPv1, SNMPv2c, SNMPv3
* **Authentication**: MD5, SHA, SHA-224, SHA-256, SHA-384, SHA-512
* **Privacy protocols**: DES, AES, AES-192, AES-256
* **Error conditions**: Timeouts, invalid OIDs, authentication failures
* **Edge cases**: Empty results, malformed data, concurrent operations

Requirements
============
Install test dependencies:

.. code-block:: bash

    pip install -r requirements.txt

Running Tests
=============

**Local Testing (Native)**

To run all tests locally:

.. code-block:: bash

    # From the repository root
    tox

To run tests with pytest directly:

.. code-block:: bash

    # From the repository root
    python3 -m pytest python_tests/

To run a specific test file:

.. code-block:: bash

    python3 -m pytest python_tests/test_session.py

To run with verbose output:

.. code-block:: bash

    python3 -m pytest -v python_tests/

**Docker-Based Testing (Recommended)**

The recommended approach for testing is to use the Docker-based testing infrastructure, which provides:

* Consistent testing environments across multiple Linux distributions
* Automated testing across Python 3.9-3.13
* Parallel execution for faster results
* Isolated test environments to prevent conflicts

.. code-block:: bash

    # Run all Python tests across all distributions
    cd docker/
    ./run_python_tests_in_all_dockers.sh

    # Run tests in a specific distribution only
    ./run_python_tests_in_all_dockers.sh almalinux10

The Docker testing infrastructure includes:

* **5 Linux distributions**: AlmaLinux 10, Arch Linux, Arch Linux (net-snmp 5.8), CentOS 7, Rocky Linux 8
* **5 Python versions**: 3.9, 3.10, 3.11, 3.12, 3.13 (25 test combinations)
* **Parallel execution**: All distributions tested simultaneously
* **Comprehensive reporting**: Test results and outputs for each combination
* **CI/CD integration**: Automated testing via GitHub Actions

For more details, see the `Docker README <../docker/README.rst>`_.

SNMP Daemon Configuration
==========================
The tests require a properly configured SNMP daemon. A sample configuration file 
``snmpd.conf`` is provided in this directory.

To set up the SNMP daemon for testing on Linux:

.. code-block:: bash

    sudo systemctl stop snmpd
    sudo mv /etc/snmp/snmpd.conf /etc/snmp/snmpd.conf.orig
    sudo cp python_tests/snmpd.conf /etc/snmp/snmpd.conf
    sudo systemctl start snmpd

On macOS:

.. code-block:: bash

    sudo mv /etc/snmp/snmpd.conf /etc/snmp/snmpd.conf.orig
    sudo cp python_tests/snmpd.conf /etc/snmp/snmpd.conf
    sudo launchctl unload /System/Library/LaunchDaemons/org.net-snmp.snmpd.plist
    sudo launchctl load -w /System/Library/LaunchDaemons/org.net-snmp.snmpd.plist

Related Documentation
=====================
* `Main README <../README.rst>`_
* `Development Guide <../sphinx_docs_build/source/development.rst>`_
* `Integration Tests <../integration_tests/README.rst>`_
* `C++ Tests <../cpp_tests/README.rst>`_

----

.. note::
   This content was generated by AI and reviewed by humans. Mistakes may still occur. PRs for corrections are welcome.
